<!doctype html>
<html lang="en" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>FAIDE® | Luxury Streetwear Brand</title>

    <!-- Tailwind (optional – you’re not relying on it heavily here, but kept) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800;900&display=swap"
      rel="stylesheet"
    />

    <style>
      :root{
        --bg:#000;
        --surface:#111;
        --text:#fff;
        --primary:#a855f7;
        --secondary:#9333ea;
        --muted:#888;
        --muted2:#777;
        --border:#1f1f1f;

        --nav-h:86px;
        --container:1200px;
        --px:32px;
        --px-sm:16px;

        --section-y:110px;
        --section-y-sm:78px;

        --h1: clamp(2.2rem, 6vw, 3.8rem);
        --h2: clamp(1.7rem, 4.4vw, 2.5rem);

        --card-radius:18px;
        --img-radius:14px;
      }

      *{ margin:0; padding:0; box-sizing:border-box; }
      html{ height:100%; scroll-behavior:smooth; }
      body{
        height:100%;
        background:var(--bg);
        color:var(--text);
        font-family:"Inter", system-ui, -apple-system, Segoe UI, sans-serif;
        overflow-x:hidden;
      }
      body.lock-scroll{ overflow:hidden; }

      /* ================= NAV ================= */
      .navbar{
        position:fixed;
        top:0; left:0; right:0;
        height:var(--nav-h);
        padding:0 var(--px);
        display:flex;
        align-items:center;
        justify-content:space-between;
        background:rgba(0,0,0,0.95);
        border-bottom:1px solid var(--border);
        backdrop-filter: blur(10px);
        z-index:1000;
        transition: height .25s ease;
      }
      .navbar.shrink{ height:72px; }

      .nav-links{
        display:flex;
        gap:18px;
        align-items:center;
      }
      .nav-links a{
        font-size:.6rem;
        letter-spacing:1px;
        text-transform:uppercase;
        color:var(--muted);
        text-decoration:none;
        white-space:nowrap;
        transition:.2s ease;
        position:relative;
      }
      .nav-links a:hover{ color:var(--secondary); transform: translateY(-1px); }
      .nav-links a::after{
        content:"";
        position:absolute;
        left:0; bottom:-4px;
        width:0; height:2px;
        background:var(--secondary);
        transition: width .25s ease;
      }
      .nav-links a:hover::after{ width:100%; }
      .nav-links a.active{ color:var(--primary); }
      .nav-links a.active::after{ width:100%; background:var(--primary); }

      @media(max-width:768px){
        .navbar{ padding:0 var(--px-sm); }
        .nav-links{
          gap:12px;
          overflow-x:auto;
          scrollbar-width:none;
          max-width:70vw;
          -webkit-overflow-scrolling:touch;
        }
        .nav-links::-webkit-scrollbar{ display:none; }
        .nav-links a{ font-size:.55rem; letter-spacing:.8px; }
      }

      #drop,#lookbook,#shop,#about,#footer{
        scroll-margin-top: calc(var(--nav-h) + 18px);
      }

      /* ================= SECTIONS ================= */
      .hero,.lookbook,.shop,.about{
        padding-top:var(--section-y);
        padding-bottom:var(--section-y);
      }
      .hero{
        padding-top: calc(var(--nav-h) + 70px);
        padding-left:var(--px);
        padding-right:var(--px);
        text-align:center;
        position:relative;
        overflow:hidden;
      }
      @media(max-width:768px){
        .hero,.lookbook,.shop,.about{
          padding-top:var(--section-y-sm);
          padding-bottom:var(--section-y-sm);
        }
        .hero{
          padding-top: calc(var(--nav-h) + 44px);
          padding-left:var(--px-sm);
          padding-right:var(--px-sm);
        }
      }

      .hero-bg{
        position:absolute;
        inset:0;
        background:url("/images/tshirt2.png") center/cover no-repeat;
        opacity:.09;
        pointer-events:none;
      }
      .hero-bg::after{
        content:"";
        position:absolute;
        inset:0;
        background: radial-gradient(80% 60% at 50% 40%, rgba(168,85,247,0.12), rgba(0,0,0,0.85) 70%, rgba(0,0,0,0.95));
      }

      .hero-title{
        font-size:var(--h1);
        font-weight:900;
        color:var(--primary);
        text-transform:uppercase;
        letter-spacing:.05em;
        text-shadow:0 0 40px rgba(147, 51, 234, .5);
        position:relative;
        z-index:1;
      }
      .hero-text{
        margin:18px auto 0;
        max-width:60ch;
        color:#aaa;
        line-height:1.6;
        position:relative;
        z-index:1;
      }
      .primary-btn{
        margin-top:28px;
        background: linear-gradient(135deg, var(--secondary), var(--primary));
        border:none;
        color:#fff;
        font-weight:900;
        letter-spacing:1px;
        text-transform:uppercase;
        padding:18px 48px;
        border-radius:999px;
        cursor:pointer;
        position:relative;
        z-index:1;
        transition:.25s ease;
        box-shadow:0 10px 30px rgba(147,51,234,.3);
      }
      .primary-btn:hover{
        background:#fff;
        color:#000;
        transform: translateY(-1px);
      }

      .section-title{
        font-size:var(--h2);
        font-weight:900;
        margin-bottom:22px;
        letter-spacing:.02em;
      }
      .purple-title{
        color:var(--primary);
        text-shadow:0 0 30px rgba(168,85,247,.25);
      }
      .aligned-title{
        max-width:var(--container);
        margin:0 auto;
        padding:0 var(--px);
      }
      @media(max-width:768px){
        .aligned-title{ padding:0 var(--px-sm); }
      }

      /* ================= LOOKBOOK ================= */
      .lookbook{ padding-left:0; padding-right:0; }
      .vertical-list{
        max-width:var(--container);
        margin:26px auto 0;
        padding:0 var(--px);
        display:flex;
        flex-direction:column;
        gap:26px;
      }
      .lookbook-card{
        height:420px;
        border-radius:var(--card-radius);
        overflow:hidden;
        background:var(--surface);
        border:1px solid rgba(255,255,255,0.10);
      }
      .lookbook-img{
        width:100%;
        height:100%;
        object-fit:cover;
        display:block;
      }
      @media(max-width:768px){
        .vertical-list{ padding:0 var(--px-sm); gap:18px; }
        .lookbook-card{ height:320px; }
      }

      /* ================= SHOP LAYOUT ================= */
      /* ✅ MOBILE = 2 column grid */
      .shop-track{
        max-width:var(--container);
        margin:0 auto;
        padding:26px var(--px);
        display:grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap:16px;
      }

      /* ✅ TABLET+DESKTOP = horizontal scroll */
      @media(min-width:768px){
        .shop-track{
          display:flex;
          overflow-x:auto;
          gap:24px;
          scroll-snap-type:x mandatory;
          scroll-behavior:smooth;
          padding:26px var(--px);
          scrollbar-width:thin;
          scrollbar-color: var(--secondary) #0b0b0b;
        }
        .shop-track::-webkit-scrollbar{ height:8px; }
        .shop-track::-webkit-scrollbar-track{ background:#0b0b0b; border-radius:10px; }
        .shop-track::-webkit-scrollbar-thumb{ background:var(--secondary); border-radius:10px; }
      }

      @media(max-width:768px){
        .shop-track{ padding:26px var(--px-sm); }
      }

      /* Product card */
      .product{
        padding:14px;
        border-radius:var(--card-radius);
        background: linear-gradient(180deg, rgba(255,255,255,0.035), rgba(255,255,255,0.015));
        border:1px solid rgba(255,255,255,0.10);
        box-shadow: 0 10px 26px rgba(0,0,0,0.70), 0 1px 0 rgba(255,255,255,0.04) inset;
        cursor:pointer;
        scroll-snap-align:center;
        transition: transform .2s ease, border-color .2s ease;
        user-select:none;
      }

      @media(min-width:768px){
        .product{ min-width:420px; }
      }

      .product:hover{
        transform: translateY(-3px);
        border-color: rgba(255,255,255,0.18);
      }

      .product-img-container{
        width:100%;
        height:320px;
        border-radius:var(--img-radius);
        overflow:hidden;
        background: radial-gradient(120% 90% at 50% 35%, rgba(255,255,255,0.035), rgba(0,0,0,0.92) 70%);
        border:1px solid rgba(255,255,255,0.10);
        display:flex;
        align-items:center;
        justify-content:center;
      }

      @media(max-width:768px){
        .product-img-container{ height:220px; }
        .product{ padding:12px; }
      }

      .product-img{
        width:100%;
        height:100%;
        object-fit:contain;
        padding:16px;
        filter: drop-shadow(0 16px 24px rgba(0,0,0,0.55));
        pointer-events:none;
        -webkit-user-drag:none;
      }

      .product-label{
        font-size:.78rem;
        text-transform:uppercase;
        letter-spacing:1.15px;
        font-weight:900;
        color:var(--primary);
        margin-top:12px;
        margin-bottom:8px;
      }
      .product h3{
        font-size:1.05rem;
        font-weight:900;
        margin:0 0 6px 0;
        line-height:1.25;
      }
      .product-category,.product-colors-count{
        color:#9a9a9a;
        font-weight:700;
        margin-bottom:6px;
      }
      .price{
        font-weight:950;
        white-space:nowrap;
      }

      /* ================= MODALS (shared) ================= */
      .gallery-modal{
        position:fixed;
        inset:0;
        background:rgba(0,0,0,0.92);
        z-index:2600;
        opacity:0;
        pointer-events:none;
        transition:opacity .25s ease;
      }
      .gallery-modal.active{
        opacity:1;
        pointer-events:auto;
      }

      .gallery-frame{
        position:absolute;
        inset:0;
        display:grid;
        grid-template-rows:auto 1fr auto;
        min-height:0; /* ✅ important for scroll math */
      }

      .gallery-topbar{
        display:flex;
        align-items:center;
        justify-content:space-between;
        gap:14px;
        padding:18px;
        border-bottom:1px solid rgba(255,255,255,0.08);
        background:rgba(10,10,10,0.55);
        backdrop-filter:blur(10px);
      }

      .gallery-meta{ display:flex; flex-direction:column; gap:4px; min-width:0; }
      .gallery-title{
        font-weight:950;
        color:var(--primary);
        letter-spacing:.04em;
        text-transform:uppercase;
        font-size:.95rem;
        white-space:nowrap;
        overflow:hidden;
        text-overflow:ellipsis;
      }
      .gallery-counter{
        color:#888;
        font-size:.85rem;
        font-weight:800;
      }

      .gallery-btn{
        border:1px solid rgba(255,255,255,0.14);
        background:rgba(255,255,255,0.03);
        color:#fff;
        padding:10px 14px;
        border-radius:999px;
        cursor:pointer;
        transition:.2s ease;
        font-weight:900;
        display:inline-flex;
        gap:8px;
        align-items:center;
      }
      .gallery-btn:hover{
        background:rgba(255,255,255,0.08);
        border-color:rgba(255,255,255,0.24);
        transform: translateY(-1px);
      }

      /* ✅ IMPORTANT: stage can scroll */
      .gallery-stage{
        position:relative;
        padding:16px;
        overflow-y:auto;    /* ✅ scroll */
        min-height:0;       /* ✅ needed to allow scrolling inside grid row */
        -webkit-overflow-scrolling:touch;
      }

      .gallery-bottombar{
        padding:12px 18px 18px;
        display:flex;
        justify-content:center;
        color:#777;
        font-size:.85rem;
        border-top:1px solid rgba(255,255,255,0.06);
        background: rgba(10,10,10,0.35);
        backdrop-filter: blur(10px);
      }

      .gallery-nav{
        position:absolute;
        top:180px;
        transform:none;
        width:52px;
        height:52px;
        border-radius:999px;
        border:1px solid rgba(255,255,255,0.14);
        background:rgba(255,255,255,0.04);
        color:#fff;
        cursor:pointer;
        display:flex;
        align-items:center;
        justify-content:center;
        transition:.2s ease;
        user-select:none;
        z-index:2;
      }
      .gallery-prev{ left:18px; }
      .gallery-next{ right:18px; }
      @media(max-width:768px){
        .gallery-nav{ width:46px; height:46px; top:150px; }
        .gallery-prev{ left:10px; }
        .gallery-next{ right:10px; }
      }

      /* Product modal interior */
      .pm-shell{
        max-width: 980px;
        margin: 0 auto;
        border-radius:18px;
        border:1px solid rgba(255,255,255,0.10);
        background:
          radial-gradient(80% 80% at 50% 35%, rgba(168,85,247,0.10), rgba(10,10,10,0.95) 70%),
          linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.00));
        padding:14px;
      }

      .pm-media{
        display:grid;
        grid-template-rows: 1fr auto;
        gap:14px;
      }

      .pm-image-shell{
        height: min(46vh, 460px);
        border-radius:16px;
        overflow:hidden;
        border:1px solid rgba(255,255,255,0.10);
        background: rgba(0,0,0,0.35);
        display:flex;
        align-items:center;
        justify-content:center;
        padding:12px;
      }

      .pm-image-shell img{
        width:100%;
        height:100%;
        object-fit:contain;
        display:block;
        transition: opacity 160ms ease;
        user-select:none;
        -webkit-user-drag:none;
      }

      .thumb-row{
        display:grid;
        grid-template-columns: repeat(4, 1fr);
        gap:12px;
      }

      .thumb{
        height:74px;
        border-radius:18px;
        overflow:hidden;
        border:2px solid rgba(255,255,255,0.10);
        background: rgba(255,255,255,0.02);
        cursor:pointer;
        transition:.18s ease;
        display:flex;
        align-items:center;
        justify-content:center;
        padding:0;
      }
      .thumb img{ width:100%; height:100%; object-fit:cover; pointer-events:none; }
      .thumb.active{
        border-color: rgba(168,85,247,0.95);
        box-shadow: 0 0 0 3px rgba(168,85,247,0.14);
      }

      .pm-details{
        width:100%;
        max-width:720px;
        margin:18px auto 0;
        padding-bottom: 10px; /* a little breathing room for scroll */
      }

      .option-label{
        font-size:.84rem;
        color:#fff;
        font-weight:900;
        margin:16px 0 10px;
      }

      .sizes{
        display:grid;
        grid-template-columns: repeat(4, 1fr);
        gap:8px;
      }

      .size-btn{
        height:42px;
        border-radius:12px;
        background: rgba(255,255,255,0.03);
        color:#b5b5b5;
        border:1px solid rgba(255,255,255,0.14);
        cursor:pointer;
        transition:.18s ease;
        font-weight:900;
        font-size:.95rem;
      }
      .size-btn.selected{
        background: linear-gradient(135deg, var(--secondary), var(--primary));
        color:#fff;
        border-color: rgba(168,85,247,0.85);
        transform: translateY(-1px);
      }

      .colors{ display:flex; gap:10px; margin-top:6px; }
      .color{
        width:38px;
        height:38px;
        border-radius:999px;
        cursor:pointer;
        border:2px solid transparent;
        position:relative;
        transition:.18s ease;
      }
      .color.black{ background:#000; border:2px solid rgba(255,255,255,0.70); }
      .color.white{ background:#fff; border:2px solid rgba(255,255,255,0.70); }
      .color.grey{ background:#666; }

      .color.selected{
        border-color: rgba(168,85,247,0.95);
        box-shadow: 0 0 0 3px rgba(168,85,247,0.14);
      }

      .qty-stepper-ui{
        display:flex;
        align-items:center;
        justify-content:space-between;
        gap:12px;
        width:100%;
        padding:10px 12px;
        border-radius:999px;
        background: rgba(255,255,255,0.035);
        border:1px solid rgba(255,255,255,0.14);
        margin-top: 16px;
      }
      .qty-btn-ui{
        width:44px;
        height:40px;
        border-radius:999px;
        border:1px solid rgba(255,255,255,0.14);
        background: rgba(255,255,255,0.02);
        color:#fff;
        cursor:pointer;
        font-weight:950;
        font-size:1.2rem;
        display:flex;
        align-items:center;
        justify-content:center;
      }
      .qty-value-ui{
        flex:1;
        text-align:center;
        font-size:1.05rem;
        font-weight:950;
      }

      .secondary-btn{
        margin-top:18px;
        width:100%;
        background: linear-gradient(135deg, var(--secondary), var(--primary));
        border:1px solid rgba(255,255,255,0.10);
        padding:16px 24px;
        border-radius:999px;
        color:#fff;
        font-weight:950;
        cursor:pointer;
        letter-spacing:1px;
        text-transform:uppercase;
        transition:.2s ease;
      }
      .secondary-btn:disabled{
        opacity:.45;
        cursor:not-allowed;
        background:#222 !important;
        color:#777 !important;
        border-color: rgba(255,255,255,0.08) !important;
        box-shadow:none !important;
        transform:none !important;
      }

      /* ================= CART (sidebar) ================= */
      .floating-cart{
        position:fixed;
        bottom:32px;
        right:32px;
        width:64px;
        height:64px;
        border-radius:50%;
        background: linear-gradient(135deg, var(--secondary), var(--primary));
        color:#fff;
        border:none;
        cursor:pointer;
        box-shadow: 0 10px 40px rgba(147, 51, 234, 0.5);
        display:flex;
        align-items:center;
        justify-content:center;
        z-index:1500;
      }
      .cart-count{
        position:absolute;
        top:0;
        right:0;
        width:24px;
        height:24px;
        border-radius:50%;
        display:flex;
        align-items:center;
        justify-content:center;
        background:#ef4444;
        border:2px solid #000;
        font-size:.75rem;
        font-weight:900;
      }
      .cart-overlay{
        position:fixed;
        inset:0;
        background: rgba(0,0,0,0.55);
        z-index:1900;
        opacity:0;
        pointer-events:none;
        transition:opacity .25s ease;
      }
      .cart-overlay.active{ opacity:1; pointer-events:auto; }

      .cart-sidebar{
        position:fixed;
        top:0;
        right:-400px;
        width:400px;
        height:100%;
        background:#0a0a0a;
        border-left:1px solid var(--border);
        z-index:2000;
        transition:right .35s ease;
        display:flex;
        flex-direction:column;
      }
      .cart-sidebar.active{ right:0; }

      .cart-header{
        padding:24px;
        border-bottom:1px solid var(--border);
        background:var(--surface);
        display:flex;
        justify-content:space-between;
        align-items:center;
      }
      .cart-header h2{
        margin:0;
        color:var(--primary);
        font-weight:900;
        font-size:1.35rem;
      }
      .close-cart{
        background:transparent;
        border:none;
        color:#888;
        cursor:pointer;
        padding:8px;
        border-radius:8px;
      }
      .close-cart:hover{ color:#fff; background:#1a1a1a; }

      .cart-items{
        flex:1;
        overflow-y:auto;
        padding:24px;
        list-style:none;
      }

      .cart-item{
        background: var(--surface);
        padding:14px;
        margin-bottom:12px;
        border-radius:14px;
        border:1px solid var(--border);
        display:grid;
        grid-template-columns: 66px 1fr auto;
        gap:12px;
        align-items:center;
      }

      .cart-item-img{
        width:66px; height:66px;
        border-radius:12px;
        border:1px solid rgba(255,255,255,0.08);
        background: rgba(255,255,255,0.02);
        object-fit:contain;
        padding:8px;
      }

      .cart-item-title{ font-weight:900; font-size:.95rem; margin-bottom:6px; }
      .cart-item-meta{ color:#9a9a9a; font-weight:700; font-size:.84rem; }
      .cart-item-price{ font-weight:950; color:var(--primary); margin-top:8px; }

      .cart-item-actions{
        display:flex;
        flex-direction:column;
        gap:10px;
        align-items:flex-end;
      }

      /* stepper pill inside cart */
      .qty-stepper{
        display:inline-flex;
        align-items:center;
        border-radius:999px;
        padding:1px;
        background: rgba(255,255,255,0.04);
        border:1px solid rgba(255,255,255,0.14);
      }
      .qty-stepper-inner{
        display:inline-flex;
        align-items:center;
        border-radius:999px;
        overflow:hidden;
        background: rgba(0,0,0,0.55);
        border:1px solid rgba(255,255,255,0.10);
      }
      .qty-btn{
        width:34px;
        height:32px;
        border:none;
        background:transparent;
        color:#fff;
        cursor:pointer;
        font-weight:950;
        font-size:1.05rem;
      }
      .qty-btn:hover{ background: rgba(255,255,255,0.08); }
      .qty-value{
        width:38px;
        text-align:center;
        font-weight:950;
      }

      .remove-btn{
        border:none;
        background:transparent;
        color:#aaa;
        cursor:pointer;
        font-weight:800;
        font-size:.85rem;
      }
      .remove-btn:hover{ color:#ef4444; }

      .cart-footer{
        padding:24px;
        border-top:1px solid var(--border);
        background: var(--surface);
      }
      .cart-total-row{
        display:flex;
        justify-content:space-between;
        align-items:center;
        margin-bottom:18px;
        font-size:1.2rem;
      }
      .cart-total-label{ color:#888; font-weight:800; }
      .cart-total-value{ color:var(--primary); font-weight:950; font-size:1.35rem; }

      .checkout-btn{
        width:100%;
        background: linear-gradient(135deg, var(--secondary), var(--primary));
        border:none;
        padding:16px;
        border-radius:999px;
        color:#fff;
        font-weight:950;
        cursor:pointer;
        text-transform:uppercase;
        letter-spacing:1px;
      }
      .checkout-btn:hover{ background:#fff; color:#000; }
      .checkout-btn:disabled{
        opacity:.45;
        cursor:not-allowed;
        background:#222 !important;
        color:#777 !important;
      }

      .cart-toast{
        position:fixed;
        bottom:110px;
        right:32px;
        background: linear-gradient(135deg, var(--secondary), var(--primary));
        color:#fff;
        padding:16px 24px;
        border-radius:12px;
        box-shadow: 0 10px 40px rgba(147, 51, 234, 0.5);
        transform: translateY(200px);
        transition: transform .35s ease;
        z-index:2200;
        display:flex;
        align-items:center;
        gap:12px;
        font-weight:800;
      }
      .cart-toast.show{ transform: translateY(0); }

      @media(max-width:768px){
        .floating-cart{ bottom:24px; right:24px; width:56px; height:56px; }
        .cart-sidebar{ width:100%; right:-100%; }
        .cart-item{
          grid-template-columns:58px 1fr;
          grid-template-areas:
            "img info"
            "img actions";
        }
        .cart-item-img{ grid-area:img; width:58px; height:58px; }
        .cart-item-info{ grid-area:info; }
        .cart-item-actions{ grid-area:actions; align-items:flex-start; flex-direction:row; justify-content:space-between; }
      }
    </style>
  </head>

  <body class="h-full w-full">
    <!-- NAVBAR -->
    <nav class="navbar">
      <a href="#drop" aria-label="FAIDE Home" style="display:flex;align-items:center;gap:10px;text-decoration:none;color:#fff;font-weight:900;">
        FAIDE
      </a>
      <div class="nav-links">
        <a href="#drop">NEW DROP</a>
        <a href="#lookbook">LOOKBOOK</a>
        <a href="#shop">SHOP</a>
        <a href="#about">ABOUT</a>
      </div>
    </nav>

    <!-- HERO -->
    <section id="drop" class="hero">
      <div class="hero-bg" aria-hidden="true"></div>
      <h2 class="hero-title" id="hero-title">NEW DROP</h2>
      <p class="hero-text" id="hero-description">
        New drops, exclusive releases, and updates are announced on our social platforms.
      </p>
      <button class="primary-btn" id="shop-now-btn" type="button">Shop Now</button>
    </section>

    <!-- LOOKBOOK -->
    <section id="lookbook" class="lookbook">
      <h2 class="section-title purple-title aligned-title">Lookbook</h2>
      <div class="vertical-list">
        <div class="lookbook-card">
          <img src="/images/lookbook1.png" alt="FAIDE Lookbook 1" class="lookbook-img" />
        </div>
        <div class="lookbook-card">
          <img src="/images/lookbook2.png" alt="FAIDE Lookbook 2" class="lookbook-img" />
        </div>
      </div>
    </section>

    <!-- ✅ PRODUCT MODAL (wired to cart) -->
    <div id="product-modal" class="gallery-modal" aria-hidden="true" role="dialog" aria-label="Product details">
      <div class="gallery-frame">
        <div class="gallery-topbar">
          <div class="gallery-meta">
            <div class="gallery-title" id="pm-title">Product</div>
            <div class="gallery-counter" id="pm-subtitle"></div>
          </div>
          <button type="button" class="gallery-btn" id="pm-close" aria-label="Close product">
            Close
            <svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M23.954 21.03l-9.184-9.095 9.092-9.174-2.832-2.807-9.09 9.179-9.176-9.088-2.81 2.81 9.186 9.105-9.095 9.184 2.81 2.81 9.112-9.192 9.18 9.1z"/>
            </svg>
          </button>
        </div>

        <div class="gallery-stage">
          <button type="button" class="gallery-nav gallery-prev" id="pm-prev" aria-label="Previous image">‹</button>

          <div class="pm-shell">
            <div class="pm-media">
              <div class="pm-image-shell">
                <img id="pm-img" alt="Product image" src="" />
              </div>
              <div class="thumb-row" id="pm-thumbs"></div>
            </div>

            <div class="pm-details" id="pm-details">
              <div style="display:flex;justify-content:space-between;gap:12px;align-items:flex-start;">
                <div style="min-width:0;">
                  <div id="pm-label" class="product-label" style="margin:0 0 8px 0;"></div>
                  <h3 id="pm-name" style="font-size:1.15rem;font-weight:950;margin:0 0 6px 0;line-height:1.25;"></h3>
                  <div id="pm-category" style="color:#9a9a9a;font-weight:800;"></div>
                  <div id="pm-colors" style="color:#9a9a9a;font-weight:800;margin-top:6px;"></div>
                </div>
                <div id="pm-price" style="font-size:1.15rem;font-weight:950;white-space:nowrap;"></div>
              </div>

              <div class="option-label">Select Size</div>
              <div class="sizes" id="pm-sizes"></div>

              <div class="option-label">Select Color</div>
              <div class="colors" id="pm-colors-row"></div>

              <div class="qty-stepper-ui" data-qty-root="pm">
                <button type="button" class="qty-btn-ui" data-qty-btn="dec" aria-label="Decrease quantity">−</button>
                <div class="qty-value-ui" data-qty-value>1</div>
                <button type="button" class="qty-btn-ui" data-qty-btn="inc" aria-label="Increase quantity">+</button>
              </div>

              <button type="button" class="secondary-btn" id="pm-add" disabled>Add to Bag</button>
            </div>
          </div>

          <button type="button" class="gallery-nav gallery-next" id="pm-next" aria-label="Next image">›</button>
        </div>

        <div class="gallery-bottombar">
          <span>Swipe images • Select size & color • Add to Bag</span>
        </div>
      </div>
    </div>

    <!-- SHOP -->
    <section id="shop" class="shop">
      <h2 class="section-title purple-title aligned-title">Shop</h2>

      <div class="shop-track" id="shop-track">
        <!-- Tank-top -->
        <div
          class="product"
          data-name="FAIDE Essentials Tank"
          data-price="199.99"
          data-label="Just In"
          data-category="Men's Tank Top"
          data-colorscount="2 Colors"
          data-image="/images/Tank%20top.png"
        >
          <div class="product-img-container">
            <img src="/images/Tank%20top.png" alt="FAIDE Essentials Tank" class="product-img" />
          </div>
          <div class="product-label">Just In</div>
          <h3>FAIDE Essentials Tank</h3>
          <div class="product-category">Men's Tank Top</div>
          <div class="product-colors-count">2 Colors</div>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-top:10px;">
            <div style="color:#777;font-weight:800;font-size:.9rem;">Tap for details</div>
            <div class="price">R199.99</div>
          </div>

          <!-- hidden variants (modal reads these) -->
          <div class="variants" hidden>
            <div class="sizes-src">S,M,L,XL</div>
            <div class="colors-src">Black,White</div>
          </div>
        </div>

        <!-- Tee -->
        <div
          class="product"
          data-name="FAIDE Signature Tee"
          data-price="349.99"
          data-label="Bestseller"
          data-category="Men's Short-Sleeve Top"
          data-colorscount="3 Colors"
          data-image="/images/tshirt.png"
        >
          <div class="product-img-container">
            <img src="/images/tshirt.png" alt="FAIDE Signature Tee" class="product-img" />
          </div>
          <div class="product-label">Bestseller</div>
          <h3>FAIDE Signature Tee</h3>
          <div class="product-category">Men's Short-Sleeve Top</div>
          <div class="product-colors-count">3 Colors</div>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-top:10px;">
            <div style="color:#777;font-weight:800;font-size:.9rem;">Tap for details</div>
            <div class="price">R349.99</div>
          </div>

          <div class="variants" hidden>
            <div class="sizes-src">S,M,L,XL</div>
            <div class="colors-src">Black,White,Grey</div>
          </div>
        </div>

        <!-- Long Sleeve -->
        <div
          class="product"
          data-name="FAIDE Long Sleeve"
          data-price="549.99"
          data-label="Member Exclusive"
          data-category="Men's Long Sleeve"
          data-colorscount="2 Colors"
          data-image="/images/longsleeve.png"
        >
          <div class="product-img-container">
            <img src="/images/longsleeve.png" alt="FAIDE Long Sleeve" class="product-img" />
          </div>
          <div class="product-label">Member Exclusive</div>
          <h3>FAIDE Long Sleeve</h3>
          <div class="product-category">Men's Long Sleeve</div>
          <div class="product-colors-count">2 Colors</div>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-top:10px;">
            <div style="color:#777;font-weight:800;font-size:.9rem;">Tap for details</div>
            <div class="price">R549.99</div>
          </div>

          <div class="variants" hidden>
            <div class="sizes-src">S,M,L,XL</div>
            <div class="colors-src">Black,White</div>
          </div>
        </div>

        <!-- Hoodie -->
        <div
          class="product"
          data-name="FAIDE Luxury Hoodie"
          data-price="699.99"
          data-label="Premium"
          data-category="Men's Pullover Hoodie"
          data-colorscount="2 Colors"
          data-image="/images/hoodie.png"
        >
          <div class="product-img-container">
            <img src="/images/hoodie.png" alt="FAIDE Luxury Hoodie" class="product-img" />
          </div>
          <div class="product-label">Premium</div>
          <h3>FAIDE Luxury Hoodie</h3>
          <div class="product-category">Men's Pullover Hoodie</div>
          <div class="product-colors-count">2 Colors</div>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-top:10px;">
            <div style="color:#777;font-weight:800;font-size:.9rem;">Tap for details</div>
            <div class="price">R699.99</div>
          </div>

          <div class="variants" hidden>
            <div class="sizes-src">S,M,L,XL</div>
            <div class="colors-src">Black,Grey</div>
          </div>
        </div>
      </div>
    </section>

    <!-- ABOUT -->
    <section id="about" class="about" style="max-width:900px;margin:0 auto;padding-left:var(--px);padding-right:var(--px);">
      <h2 class="section-title purple-title">About FAIDE</h2>
      <p style="color:#aaa;line-height:1.8;">
        FAIDE is a luxury streetwear brand built for those who move in silence. Designed with intention. Worn with purpose.
      </p>

      <div style="margin-top:18px;display:grid;gap:10px;">
        <div style="color:var(--primary);font-weight:900;text-transform:uppercase;letter-spacing:1px;">Contact</div>
        <a style="color:#888;text-decoration:none;width:fit-content;" href="mailto:faideclothingsa@gmail.com">faideclothingsa@gmail.com</a>
        <a style="color:#888;text-decoration:none;width:fit-content;" href="tel:+27695603929">+27 69 560 3929</a>
      </div>
    </section>

    <!-- FOOTER -->
    <footer id="footer" style="background:#0a0a0a;border-top:1px solid var(--border);padding:42px 32px 40px;">
      <div style="max-width:1200px;margin:0 auto;text-align:center;color:#666;">
        © 2026 FAIDE. All rights reserved.
      </div>
    </footer>

    <!-- Cart overlay -->
    <div id="cart-overlay" class="cart-overlay" aria-hidden="true"></div>

    <!-- Floating Cart Button -->
    <button id="floating-cart" class="floating-cart" aria-label="View shopping cart" type="button">
      <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
        <path d="M10 19.5c0 .829-.672 1.5-1.5 1.5s-1.5-.671-1.5-1.5c0-.828.672-1.5 1.5-1.5s1.5.672 1.5 1.5zm3.5-1.5c-.828 0-1.5.671-1.5 1.5s.672 1.5 1.5 1.5 1.5-.671 1.5-1.5c0-.828-.672-1.5-1.5-1.5zm6.304-15l-3.431 12h-2.102l2.542-9h-16.813l4.615 11h13.239l3.474-12h1.929l.743-2h-4.196z"/>
      </svg>
      <span id="cart-count" class="cart-count">0</span>
    </button>

    <!-- Cart Sidebar -->
    <div id="cart-sidebar" class="cart-sidebar" aria-label="Shopping cart">
      <div class="cart-header">
        <h2>Your Cart</h2>
        <button id="close-cart" class="close-cart" aria-label="Close cart" type="button">
          <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
            <path d="M23.954 21.03l-9.184-9.095 9.092-9.174-2.832-2.807-9.09 9.179-9.176-9.088-2.81 2.81 9.186 9.105-9.095 9.184 2.81 2.81 9.112-9.192 9.18 9.1z"/>
          </svg>
        </button>
      </div>

      <ul id="cart-items" class="cart-items"></ul>

      <div class="cart-footer">
        <div class="cart-total-row">
          <span class="cart-total-label">Total:</span>
          <span class="cart-total-value">R<span id="cart-total">0.00</span></span>
        </div>

        <button class="checkout-btn" id="checkout-btn" type="button" disabled title="Add items to checkout">
          Proceed to Checkout
        </button>
      </div>
    </div>

    <!-- Cart Toast -->
    <div class="cart-toast" id="cartToast" role="status" aria-live="polite">
      <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
        <path d="M10 19.5c0 .829-.672 1.5-1.5 1.5s-1.5-.671-1.5-1.5c0-.828.672-1.5 1.5-1.5s1.5.672 1.5 1.5zm3.5-1.5c-.828 0-1.5.671-1.5 1.5s.672 1.5 1.5 1.5 1.5-.671 1.5-1.5c0-.828-.672-1.5-1.5-1.5zm6.304-15l-3.431 12h-2.102l2.542-9h-16.813l4.615 11h13.239l3.474-12h1.929l.743-2h-4.196z"/>
      </svg>
      <span id="cartMessage">Added to cart!</span>
    </div>

    <script>
      /*************************************************************
       * Helpers
       *************************************************************/
      function clickOnEnterSpace(el, fn) {
        el.addEventListener("keydown", (e) => {
          if (e.key === "Enter" || e.key === " ") {
            e.preventDefault();
            fn(e);
          }
        });
      }

      function getNavOffsetPx() {
        const nav = document.querySelector(".navbar");
        return Math.round((nav?.getBoundingClientRect?.().height || 86) + 18);
      }
      function scrollToSectionId(id) {
        const el = document.getElementById(id);
        if (!el) return;
        const top = el.getBoundingClientRect().top + window.pageYOffset - getNavOffsetPx();
        window.scrollTo({ top, behavior: "smooth" });
      }

      /*************************************************************
       * Qty stepper (shared)
       *************************************************************/
      function setupQtyStepper(rootEl, { onChange } = {}) {
        const valueEl = rootEl.querySelector("[data-qty-value]");
        const incBtn = rootEl.querySelector('[data-qty-btn="inc"]');
        const decBtn = rootEl.querySelector('[data-qty-btn="dec"]');
        if (!valueEl || !incBtn || !decBtn) return;

        let qty = 1;

        const render = () => {
          valueEl.textContent = String(qty);
          onChange?.(qty);
        };

        const setQty = (next) => {
          qty = Math.max(1, next);
          render();
        };

        incBtn.addEventListener("click", (e) => { e.preventDefault(); setQty(qty + 1); });
        decBtn.addEventListener("click", (e) => { e.preventDefault(); setQty(qty - 1); });

        return { getQty: () => qty, setQty };
      }

      /*************************************************************
       * Cart + WhatsApp
       *************************************************************/
      const WHATSAPP_NUMBER = "27695603929";
      let cart = [];

      function showCartToast(message) {
        const toast = document.getElementById("cartToast");
        const messageEl = document.getElementById("cartMessage");
        if (!toast || !messageEl) return;
        messageEl.textContent = message;
        toast.classList.add("show");
        clearTimeout(window.__toastTimer);
        window.__toastTimer = setTimeout(() => toast.classList.remove("show"), 3000);
      }

      function checkoutOnWhatsApp() {
        if (!cart || cart.length === 0) return showCartToast("Your cart is empty.");

        const lines = [];
        lines.push("Hi FAIDE, I want to place an order:");
        lines.push("");

        let total = 0;
        cart.forEach((item, i) => {
          const lineTotal = item.price * item.quantity;
          total += lineTotal;
          lines.push(`${i + 1}) ${item.name} | Size: ${item.size} | Color: ${item.color} | Qty: ${item.quantity} | R${lineTotal.toFixed(2)}`);
        });

        lines.push("");
        lines.push(`TOTAL: R${total.toFixed(2)}`);
        lines.push("");
        lines.push("Name:");
        lines.push("(Type here)");
        lines.push("");
        lines.push("Delivery address:");
        lines.push("(Type here)");

        const message = encodeURIComponent(lines.join("\n"));
        window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${message}`, "_blank", "noopener,noreferrer");
      }

      function setCheckoutState() {
        const checkoutBtn = document.getElementById("checkout-btn");
        if (!checkoutBtn) return;
        const empty = cart.length === 0;
        checkoutBtn.disabled = empty;
        checkoutBtn.title = empty ? "Add items to checkout" : "Proceed to WhatsApp checkout";
      }

      function updateCartUI() {
        const cartItemsEl = document.getElementById("cart-items");
        const cartTotalEl = document.getElementById("cart-total");
        const cartCountEl = document.getElementById("cart-count");
        if (!cartItemsEl || !cartTotalEl || !cartCountEl) return;

        cartItemsEl.innerHTML = "";
        let total = 0;
        let itemCount = 0;

        if (cart.length === 0) {
          cartItemsEl.innerHTML =
            '<li style="text-align:center;color:#666;border:none;background:transparent;padding:14px 0;">Your cart is empty</li>';
          cartTotalEl.textContent = "0.00";
          cartCountEl.textContent = "0";
          setCheckoutState();
          return;
        }

        cart.forEach((item, idx) => {
          const lineTotal = item.price * item.quantity;
          total += lineTotal;
          itemCount += item.quantity;

          const li = document.createElement("li");
          li.className = "cart-item";

          li.innerHTML = `
            <img class="cart-item-img" src="${item.image || ""}" alt="${item.name}" onerror="this.style.display='none';" />
            <div class="cart-item-info">
              <div class="cart-item-title">${item.name}</div>
              <div class="cart-item-meta">Size: ${item.size} • Color: ${item.color}</div>
              <div class="cart-item-price">R${lineTotal.toFixed(2)}</div>
            </div>
            <div class="cart-item-actions">
              <div class="qty-stepper" aria-label="Quantity controls">
                <div class="qty-stepper-inner">
                  <button type="button" class="qty-btn" data-action="dec" aria-label="Decrease quantity">−</button>
                  <div class="qty-value" aria-label="Quantity">${item.quantity}</div>
                  <button type="button" class="qty-btn" data-action="inc" aria-label="Increase quantity">+</button>
                </div>
              </div>
              <button type="button" class="remove-btn" data-action="remove" aria-label="Remove item">Remove</button>
            </div>
          `;

          li.querySelector('[data-action="dec"]').addEventListener("click", () => {
            item.quantity = Math.max(1, item.quantity - 1);
            updateCartUI();
          });
          li.querySelector('[data-action="inc"]').addEventListener("click", () => {
            item.quantity += 1;
            updateCartUI();
          });
          li.querySelector('[data-action="remove"]').addEventListener("click", () => {
            cart.splice(idx, 1);
            updateCartUI();
          });

          cartItemsEl.appendChild(li);
        });

        cartTotalEl.textContent = total.toFixed(2);
        cartCountEl.textContent = String(itemCount);
        setCheckoutState();
      }

      function openCart() {
        document.getElementById("cart-sidebar")?.classList.add("active");
        document.getElementById("cart-overlay")?.classList.add("active");
        document.body.classList.add("lock-scroll");
      }
      function closeCartPanel() {
        document.getElementById("cart-sidebar")?.classList.remove("active");
        document.getElementById("cart-overlay")?.classList.remove("active");
        document.body.classList.remove("lock-scroll");
      }

      /*************************************************************
       * Product modal (wired to cart)
       *************************************************************/
      const pm = {
        modal: document.getElementById("product-modal"),
        close: document.getElementById("pm-close"),
        prev: document.getElementById("pm-prev"),
        next: document.getElementById("pm-next"),
        img: document.getElementById("pm-img"),
        thumbs: document.getElementById("pm-thumbs"),
        subtitle: document.getElementById("pm-subtitle"),

        label: document.getElementById("pm-label"),
        name: document.getElementById("pm-name"),
        category: document.getElementById("pm-category"),
        colorsCount: document.getElementById("pm-colors"),
        price: document.getElementById("pm-price"),

        sizes: document.getElementById("pm-sizes"),
        colorsRow: document.getElementById("pm-colors-row"),
        add: document.getElementById("pm-add"),
      };

      let pmSources = [];
      let pmIndex = 0;
      let pmActiveProductEl = null;

      const pmStepperRoot = document.querySelector('.qty-stepper-ui[data-qty-root="pm"]');
      const pmStepper = pmStepperRoot ? setupQtyStepper(pmStepperRoot) : null;

      function imageExists(src, timeoutMs = 800) {
        return new Promise((resolve) => {
          const img = new Image();
          let done = false;
          const finish = (ok) => {
            if (done) return;
            done = true;
            resolve(ok);
          };
          const t = setTimeout(() => finish(false), timeoutMs);
          img.onload = () => { clearTimeout(t); finish(true); };
          img.onerror = () => { clearTimeout(t); finish(false); };
          img.src = src;
        });
      }

      function buildVariantSrc(baseSrc, n) {
        const qIndex = baseSrc.indexOf("?");
        const clean = qIndex >= 0 ? baseSrc.slice(0, qIndex) : baseSrc;
        const query = qIndex >= 0 ? baseSrc.slice(qIndex) : "";
        const dot = clean.lastIndexOf(".");
        if (dot < 0) return baseSrc;
        const left = clean.slice(0, dot);
        const ext = clean.slice(dot);
        return `${left}${n}${ext}${query}`;
      }

      async function pmBuildImagesFromProduct(productEl) {
        const base = productEl.getAttribute("data-image") || productEl.querySelector(".product-img")?.getAttribute("src") || "";
        if (!base) return [""];
        const candidates = [base, buildVariantSrc(base, 2), buildVariantSrc(base, 3), buildVariantSrc(base, 4)];
        const checks = await Promise.all(candidates.map((s, i) => (i === 0 ? Promise.resolve(true) : imageExists(s))));
        return candidates.filter((_, i) => checks[i]).slice(0, 4);
      }

      function pmRenderThumbs() {
        if (!pm.thumbs) return;
        pm.thumbs.innerHTML = "";
        pmSources.slice(0,4).forEach((src, i) => {
          const btn = document.createElement("button");
          btn.type = "button";
          btn.className = "thumb" + (i === pmIndex ? " active" : "");
          btn.innerHTML = `<img src="${src}" alt="" loading="lazy" />`;
          btn.addEventListener("click", (e) => {
            e.preventDefault();
            e.stopPropagation();
            pmSetImage(i);
          });
          pm.thumbs.appendChild(btn);
        });
      }

      function pmSetImage(i) {
        if (!pmSources.length || !pm.img) return;
        pmIndex = (i + pmSources.length) % pmSources.length;
        pm.img.style.opacity = "0.25";
        requestAnimationFrame(() => {
          pm.img.src = pmSources[pmIndex];
          if (pm.subtitle) pm.subtitle.textContent = `${pmIndex + 1} / ${pmSources.length}`;
          pmRenderThumbs();
          setTimeout(() => (pm.img.style.opacity = "1"), 60);
        });
      }

      function pmOpen() {
        pm.modal?.classList.add("active");
        pm.modal?.setAttribute("aria-hidden", "false");
        document.body.classList.add("lock-scroll");
        pm.close?.focus();
      }

      function pmClose() {
        pm.modal?.classList.remove("active");
        pm.modal?.setAttribute("aria-hidden", "true");
        document.body.classList.remove("lock-scroll");
        pmActiveProductEl = null;
      }

      function pmUpdateAddState() {
        const selectedSize = pm.sizes.querySelector(".size-btn.selected");
        const selectedColor = pm.colorsRow.querySelector(".color.selected");
        pm.add.disabled = !(selectedSize && selectedColor);
      }

      function pmRenderSizes(productEl) {
        const sizesStr = productEl.querySelector(".sizes-src")?.textContent?.trim() || "S,M,L,XL";
        const sizes = sizesStr.split(",").map(s => s.trim()).filter(Boolean);

        pm.sizes.innerHTML = "";
        sizes.forEach((s) => {
          const btn = document.createElement("button");
          btn.type = "button";
          btn.className = "size-btn";
          btn.textContent = s;
          btn.addEventListener("click", () => {
            pm.sizes.querySelectorAll(".size-btn").forEach(x => x.classList.remove("selected"));
            btn.classList.add("selected");
            pmUpdateAddState();
          });
          pm.sizes.appendChild(btn);
        });
      }

      function pmColorClass(name){
        const n = name.toLowerCase();
        if (n.includes("black")) return "color black";
        if (n.includes("white")) return "color white";
        if (n.includes("grey") || n.includes("gray")) return "color grey";
        return "color grey";
      }

      function pmRenderColors(productEl) {
        const colorsStr = productEl.querySelector(".colors-src")?.textContent?.trim() || "Black,White";
        const colors = colorsStr.split(",").map(s => s.trim()).filter(Boolean);

        pm.colorsRow.innerHTML = "";
        colors.forEach((c) => {
          const div = document.createElement("div");
          div.className = pmColorClass(c);
          div.setAttribute("role","button");
          div.setAttribute("tabindex","0");
          div.setAttribute("aria-label", c);
          div.setAttribute("data-color", c);

          const select = () => {
            pm.colorsRow.querySelectorAll(".color").forEach(x => x.classList.remove("selected"));
            div.classList.add("selected");
            pmUpdateAddState();
          };

          div.addEventListener("click", (e) => { e.preventDefault(); e.stopPropagation(); select(); });
          clickOnEnterSpace(div, select);

          pm.colorsRow.appendChild(div);
        });
      }

      function pmFillMeta(productEl) {
        const name = productEl.getAttribute("data-name") || "Item";
        const price = `R${Number(productEl.getAttribute("data-price") || "0").toFixed(2)}`;
        const label = productEl.getAttribute("data-label") || "";
        const category = productEl.getAttribute("data-category") || "";
        const colorsCount = productEl.getAttribute("data-colorscount") || "";

        pm.label.textContent = label;
        pm.name.textContent = name;
        pm.category.textContent = category;
        pm.colorsCount.textContent = colorsCount;
        pm.price.textContent = price;

        pmStepper?.setQty?.(1);
        pm.add.disabled = true;
      }

      async function openProductModal(productEl) {
        pmActiveProductEl = productEl;
        pmFillMeta(productEl);

        pmRenderSizes(productEl);
        pmRenderColors(productEl);

        pmSources = await pmBuildImagesFromProduct(productEl);
        pmSetImage(0);

        pmOpen();
      }

      /*************************************************************
       * DOM Ready
       *************************************************************/
      document.addEventListener("DOMContentLoaded", async () => {
        // nav shrink
        const navbar = document.querySelector(".navbar");
        const navLinks = document.querySelectorAll(".nav-links a");

        function handleShrink(){
          navbar?.classList.toggle("shrink", window.scrollY > 20);
        }
        handleShrink();
        window.addEventListener("scroll", handleShrink, { passive:true });

        // nav active
        const sectionIds = ["drop","lookbook","shop","about"];
        const sections = sectionIds.map(id => document.getElementById(id)).filter(Boolean);
        const linkById = new Map();
        navLinks.forEach(a => {
          const href = a.getAttribute("href") || "";
          if (href.startsWith("#")) linkById.set(href.slice(1), a);
        });

        function setActive(id){
          navLinks.forEach(a => a.classList.remove("active"));
          linkById.get(id)?.classList.add("active");
        }

        let navLock = false;
        let navUnlockTimer = null;
        navLinks.forEach((a) => {
          a.addEventListener("click", (e) => {
            const href = a.getAttribute("href") || "";
            if (!href.startsWith("#")) return;
            const id = href.slice(1);
            e.preventDefault();

            navLock = true;
            clearTimeout(navUnlockTimer);
            setActive(id);
            scrollToSectionId(id);

            navUnlockTimer = setTimeout(() => { navLock = false; }, 650);
          });
        });

        let raf = null;
        function updateActiveFromScroll(){
          if (navLock) return;
          const refY = window.scrollY + getNavOffsetPx() + 10;
          let current = sections[0]?.id || "drop";
          for (const sec of sections){
            if (sec.offsetTop <= refY) current = sec.id;
          }
          setActive(current);
        }

        function onScroll(){
          if (raf) return;
          raf = requestAnimationFrame(() => {
            raf = null;
            updateActiveFromScroll();
          });
        }
        updateActiveFromScroll();
        window.addEventListener("scroll", onScroll, { passive:true });
        window.addEventListener("resize", updateActiveFromScroll, { passive:true });

        // hero button
        document.getElementById("shop-now-btn")?.addEventListener("click", () => scrollToSectionId("shop"));

        // cart open/close
        document.getElementById("floating-cart")?.addEventListener("click", openCart);
        document.getElementById("close-cart")?.addEventListener("click", closeCartPanel);
        document.getElementById("cart-overlay")?.addEventListener("click", closeCartPanel);
        document.getElementById("checkout-btn")?.addEventListener("click", (e) => {
          const btn = e.currentTarget;
          if (btn.disabled) return showCartToast("Add items to checkout.");
          checkoutOnWhatsApp();
        });

        updateCartUI();

        // wire products -> open modal
        const products = document.querySelectorAll(".product");
        products.forEach((productEl) => {
          productEl.addEventListener("click", () => openProductModal(productEl));
        });

        // modal controls
        pm.close?.addEventListener("click", pmClose);
        pm.modal?.addEventListener("click", (e) => { if (e.target === pm.modal) pmClose(); });

        pm.prev?.addEventListener("click", () => pmSetImage(pmIndex - 1));
        pm.next?.addEventListener("click", () => pmSetImage(pmIndex + 1));

        // swipe image inside modal
        let pmTouchStartX = null;
        pm.img?.addEventListener("touchstart", (e) => {
          if (!e.touches || e.touches.length !== 1) return;
          pmTouchStartX = e.touches[0].clientX;
        }, { passive:true });

        pm.img?.addEventListener("touchend", (e) => {
          if (pmTouchStartX == null) return;
          const endX = e.changedTouches?.[0]?.clientX ?? pmTouchStartX;
          const diff = endX - pmTouchStartX;
          pmTouchStartX = null;
          if (Math.abs(diff) < 35) return;
          if (diff < 0) pmSetImage(pmIndex + 1);
          else pmSetImage(pmIndex - 1);
        }, { passive:true });

        // add to bag (modal -> cart)
        pm.add?.addEventListener("click", () => {
          if (!pmActiveProductEl) return;

          const productName = pmActiveProductEl.getAttribute("data-name") || "Item";
          const price = parseFloat(pmActiveProductEl.getAttribute("data-price") || "0");

          const selectedSize = pm.sizes.querySelector(".size-btn.selected");
          const selectedColor = pm.colorsRow.querySelector(".color.selected");
          if (!selectedSize) return showCartToast("Select a size first.");
          if (!selectedColor) return showCartToast("Select a color first.");

          let quantity = pmStepper?.getQty?.() ?? 1;
          quantity = Math.max(1, Number.isFinite(quantity) ? quantity : 1);

          const size = selectedSize.textContent.trim();
          const colorName = selectedColor.getAttribute("data-color") || "Color";
          const image = pmSources[pmIndex] || pmActiveProductEl.getAttribute("data-image") || "";

          const itemKey = `${productName}-${size}-${colorName}`;
          const existing = cart.find((item) => item.key === itemKey);

          if (existing) existing.quantity += quantity;
          else cart.push({ key: itemKey, name: productName, price, size, color: colorName, quantity, image });

          updateCartUI();
          showCartToast(`Added ${quantity}x ${productName} (${size}) in ${colorName}`);
          pmClose();
        });

        // enable/disable Add to Bag based on selections
        const observeSelections = () => pmUpdateAddState();
        const origRenderSizes = pmRenderSizes;
        const origRenderColors = pmRenderColors;

        // wrap renders to ensure state updates
        pmRenderSizes = (p) => { origRenderSizes(p); observeSelections(); };
        pmRenderColors = (p) => { origRenderColors(p); observeSelections(); };

        // keyboard escape
        document.addEventListener("keydown", (e) => {
          if (e.key !== "Escape") return;
          if (pm.modal?.classList.contains("active")) pmClose();
          if (document.getElementById("cart-sidebar")?.classList.contains("active")) closeCartPanel();
        });

        // whenever size/color changes, enable add
        const origOpen = openProductModal;
        openProductModal = async (p) => {
          await origOpen(p);
          pmUpdateAddState();
        };

        // immediate: make sure add state updates when you click size/color
        // (handlers already call pmUpdateAddState)
      });

      // fix: after initial script loads (pmRenderSizes/colors overridden after DOM ready)
      // we still need pmUpdateAddState to run on selection clicks – already done.
      // But we must ensure pmUpdateAddState exists before override usage.
    </script>
  </body>
</html>